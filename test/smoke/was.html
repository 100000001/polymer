<!doctype html>
<html>
<head>

  <title>is/was (extension)</title>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="../../../webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="../../polymer.html">
  <link rel="import" href="../../src/lib/polymer-was.html">

</head>
<body>

  <dom-module id="x-base">
    <template strip-whitespace>
      <style>
        :host {
          display: block;
          border: 1px dashed orange;
          margin: 8px;
          padding: 8px;
        }
      </style>
      x-base: {{value}}
    </template>
    <script>
    // note: don't have to do anything to be `was-able`
    HTMLImports.whenReady(function() {
      Polymer({

        is: 'x-base',

        hostAttributes: {
          nug: true
        },

        listeners: {
          'tap': 'baseTap'
        },

        properties: {
          value: {
            value: 'stamped!',
            observer: '_valueChanged'
          },

          foo: {
            value: 'foo'
          }
        },

        observers: [
          '_fooChanged(foo)'
        ],

        ready: function() {
          console.log('***');
          console.log('I x-base.ready', this.is);
        }, 

        go: function() {
          console.log('***');
          console.log(this.is, 'x-base.go!');
        },

        baseTap: function(e) {
          console.log(e.target.localName, e.type);
        },

        _valueChanged: function() {
          //console.log(this.is, this.value);
        },

        _fooChanged: function() {
          //console.log(this.is, this.foo);
        }

      });
    });
    </script>
  </dom-module>

  <dom-module id="x-base1">
    <script>
    // note: don't have to do anything to be `was-able`
    HTMLImports.whenReady(function() {
      Polymer({

        is: 'x-base1',
        was: 'x-base',

        behaviors: [ Polymer.Was ]

      });
    });
    </script>
  </dom-module>

  <dom-module id="x-extend">
    <template strip-whitespace>
      <style>
        :host {
          display: block;
          border: 1px dashed orange;
          margin: 8px;
          padding: 8px;
        }
      </style>
      <span>&raquo;</span>
      x-extend: {{value}} {{value2}}
      <span>&laquo;</span>
    </template>
    <script>
    HTMLImports.whenReady(function() {
      Polymer({

        is: 'x-extend',

        was: 'x-base',

        behaviors: [ Polymer.Was ],

        hostAttributes: {
          bar: true
        },

        properties: {
          value2: {
            value: 'stamp2!'
          }
        },

        // observers: [
        //   'stuffHappened(value, value2)'
        // ],

        ready: function() {
          this._getWas('x-base').ready.call(this);
          console.log('I am x-extend.ready', this.is);
        },

        go: function() {
          this._getWas('x-base').go.call(this);
          console.log(this.is, 'x-extend.go!');
        },

        stuffHappened: function(a, b) {
          console.log(this.is, 'stuffHappened', a, b);
        }

      });
    });
    </script>
  </dom-module>

  <dom-module id="x-extend2">
    <template strip-whitespace>
      <style>
        :host {
          display: block;
          border: 1px dashed red;
          margin: 8px;
          padding: 8px;
        }
      </style>
      <div>x-extend2: {{value}} wha huh?</div>
      <div>value2 gets routed here: {{value2}}</div>
      <div>end</div>
    </template>
    <script>
    HTMLImports.whenReady(function() {
      Polymer({

        is: 'x-extend2',

        was: 'x-extend',

        behaviors: [ Polymer.Was ],

        properties: {
          value3: {
            value: 'stamp3!'
          }
        },

        // observers: [
        //   'stuffHappened2(value, value2, value3)'
        // ],

        ready: function() {
          //this._getWas('x-extend').ready.call(this);
          console.log('I am x-extend2.ready', this.is);
        },

        go: function() {
          this._getWas('x-extend').go.call(this);
          console.log(this.is, 'x-extend2.go!');
        },

        stuffHappened2: function() {
          console.log(this.is, 'stuffHappened2', arguments);
        }

      });
    });
    </script>
  </dom-module>

  <dom-module id="x-extend3">
    <style>
      :host {
        display: block;
        border: 1px dashed blue;
        margin: 8px;
        padding: 8px;
      }
    </style>
    <script>
    HTMLImports.whenReady(function() {
      Polymer({

        is: 'x-extend3',

        was: 'x-extend2',

        behaviors: [ Polymer.Was ]
      });
    });
    </script>
  </dom-module>

  <dom-module id="x-extend4">
    <style>
      :host {
        display: block;
        border: 1px dashed blue;
        margin: 8px;
        padding: 8px;
      }
    </style>
    <script>
    HTMLImports.whenReady(function() {
      Polymer({

        is: 'x-extend4',

        was: 'x-extend3',

        listeners: {
          'tap': 'tap4'
        },

        behaviors: [ Polymer.Was ],

        tap4: function(e) {
          console.log('extend4.tap listener');
        }
      });
    });
    </script>
  </dom-module>

  <!-- <x-base></x-base> -->

  <!-- <x-base1></x-base1> -->

  <x-extend></x-extend>

  <x-extend2></x-extend2>

  <x-extend3></x-extend3>

  <x-extend4></x-extend4>

  <script>
  addEventListener('WebComponentsReady', function() {
    console.log('*****');
    // document.querySelector('x-base').go();
    // document.querySelector('x-extend').go();
    // document.querySelector('x-extend2').go();
    // document.querySelector('x-extend3').go();
    // document.querySelector('x-extend4').go();
  });
  </script>

</body>
</html>
